# =============================================================================
# Required Parameters
# =============================================================================
# The project ID is required for all GCP resource creation
# This should be a valid GCP project with the necessary APIs enabled

project_id = "your-project-id"

# =============================================================================
# Network Configuration
# =============================================================================
# Define your region for deployment
# Region requirements:
#  - A pre-existing VPC network
#  - A pre-existing subnet within that network
#  - Proper firewall rules (created automatically by this module)

regions = [{
  region      = "us-central1"     # Primary region for deployment
  network     = "pexip-infinity"  # Name of existing VPC network
  subnet_name = "pexip-subnet"    # Name of existing subnet in the VPC
}]

# =============================================================================
# Management Access Configuration
# =============================================================================
# Define CIDR ranges that can access management interfaces
# This includes:
#  - SSH access (port 22)
#  - Admin UI (port 443)
#  - Conferencing Node Provisioning (port 8443)

management_access = {
  cidr_ranges = ["0.0.0.0/0"]  # Replace with your allowed IP ranges
}

# =============================================================================
# Image Configuration
# =============================================================================
# Option 1: Using existing images from your GCP project
pexip_images = {
  upload_files = false  # Set to false when using existing GCP images
  management = {
    image_name = "pexip-infinity-management-v36"  # Name of existing management node image in GCP
  }
  conferencing = {
    image_name = "pexip-infinity-conferencing-v36"  # Name of existing conferencing node image in GCP
  }
}

# Option 2: Uploading new images from local files
# Uncomment and modify the following block if you want to upload new images
# pexip_images = {
#   upload_files = true   # Set to true to upload new images
#   management = {
#     source_file = "/path/to/Pexip_Infinity_Management_Node_v36.tar.gz"
#     image_name  = "pexip-infinity-management-v36"
#   }
#   conferencing = {
#     source_file = "/path/to/Pexip_Infinity_Conferencing_Node_v36.tar.gz"
#     image_name  = "pexip-infinity-conferencing-v36"
#   }
# }

# =============================================================================
# Node Configurations
# =============================================================================
# Management Node Configuration
# This node handles all system configuration
management_node = {
  name      = "mgmt-1"
  region    = "us-central1"   # Must match one of the regions above
  public_ip = true           # Set false for internal-only access
}

# Transcoding Node Configuration
transcoding_nodes = {
  regional_config = {
    "us-central1" = {
      count     = 1
      name      = "transcode"
      public_ip = true       # Required for external participants
      machine_type = "n2-highcpu-8"
    }
  }
}
